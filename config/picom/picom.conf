#################################
#          Transparencia          #
#################################

# Transparencia de ventanas inactivas (85%)
inactive-opacity = 0.85

# Transparencia de ventanas activas (95% - casi opaco)
active-opacity = 0.95;

# Transparencia específica por aplicación
opacity-rule = [
    "100:fullscreen",                      # TODAS las ventanas en fullscreen 100% opacas
    "90:class_g = 'Polybar'",           # Polybar ligeramente transparente
    "90:class_g = 'kitty' && focused",  # Kitty activo casi opaco
    "75:class_g = 'kitty' && !focused", # Kitty inactivo con blur visible
    "100:class_g = 'Chromium' && fullscreen", # Firefox sin efectos en fullscreen
    "100:class_g = 'netflix.com'", # Netflix sin efectos en fullscreen
    "100:class_g = 'youtube.com'", # Netflix sin efectos en fullscreen
    "95:class_g = 'Chromium' && !fullscreen", # Firefox normal
    "85:class_g = 'Rofi'",              # Rofi con transparencia para blur
    "80:class_g = 'dunst'",             # Notificaciones con blur
    "100:class_g = 'i3lock'",            # Sin transparencia en lockscreen
    "90:class_g = 'dolphin'",
    "95:class_g = 'Cursor'",
    "95:class_g = 'Cursor'",
    "95:class_g = 'Neovim'",
    "95:class_g = 'Kate'",
    "100:class_g = 'okular'",
    "100:class_g = 'Zathura'",            # Zathura (lector PDF) con transparencia
    "100:class_g = 'Evince'",             # Evince (lector PDF) con transparencia
    "100:class_g = 'Okular'",             # Okular (lector PDF) con transparencia
    "100:class_g = 'Xreader'",            # Xreader (lector PDF) con transparencia
    "100:class_g = 'MuPDF'",              # MuPDF (lector PDF) con transparencia
    "100:class_g = 'qpdfview'",           # qpdfview (lector PDF) con transparencia
    "100:class_g = 'Atril'",              # Atril (lector PDF) con transparencia
    "100:class_g = 'Zathura' && class_i = 'pdf'",      # Zathura abriendo PDF
    "100:class_g = 'Okular' && class_i = 'pdf'",       # Okular abriendo PDF
    "100:class_g = 'Evince' && class_i = 'pdf'",       # Evince abriendo PDF
    "100:class_g = 'Xreader' && class_i = 'pdf'",      # Xreader abriendo PDF
    "100:class_g = 'MuPDF' && class_i = 'pdf'",        # MuPDF abriendo PDF
    "100:class_g = 'qpdfview' && class_i = 'pdf'",     # qpdfview abriendo PDF
    "100:class_g = 'Atril' && class_i = 'pdf'",        # Atril abriendo PDF
];

#################################
#        Bordes redondeados       #
#################################

# Radio de esquinas redondeadas (16px - más redondeado)
corner-radius = 16;

# Grosor del borde de las esquinas redondeadas (1px)
corner-radius-width = 5;
# Color de las esquinas redondeadas (match con i3/polybar Tokyo Night)
corner-color = "#1a1b26";  # Tokyo Night background (igual que en polybar/i3)


# Excluir ciertas ventanas de bordes redondeados
rounded-corners-exclude = [
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "class_g = 'Polybar'",              # Polybar mantiene sus bordes
    "class_g = 'i3-frame'",             # Contenedores de i3
    "fullscreen",                        # Sin bordes en fullscreen
    "class_g = 'Rofi'"
];

#################################
#              Blur               #
#################################

# Activar blur de fondo
blur-background = true;

# Método de blur (dual_kawase es el más eficiente y bonito)
blur-method = "dual_kawase";

# Intensidad del blur (1-20, recomendado 3-6)
blur-strength = 3;

# Blur para ventanas inactivas solamente
blur-background-frame = true;
blur-background-fixed = true;

# Excluir blur en ciertas ventanas (mejor rendimiento)
blur-background-exclude = [
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "class_g = 'Polybar'",
    "class_g = 'i3lock'",
    "fullscreen",
    "_GTK_FRAME_EXTENTS@"
];

#################################
#           Animaciones           #
#################################

# Activar animaciones fade
fading = true;

# Tiempo de fade in/out (milisegundos)
fade-in-step = 0.04;   # Velocidad fade in (más lento)
fade-out-step = 0.04;  # Velocidad fade out (más lento)

# Tiempo total de animación
fade-delta = 10;

# Excluir fade en ciertas ventanas
fade-exclude = [
    "class_g = 'i3lock'",
    "fullscreen"
];

#################################
#            Sombras              #
#################################

# Activar sombras sutiles
shadow = true;

# Configuración de sombras
shadow-radius = 12;      # Radio de sombra
shadow-offset-x = -8;    # Desplazamiento horizontal
shadow-offset-y = -8;    # Desplazamiento vertical
shadow-opacity = 0.4;    # Opacidad de sombra (sutil)

# Color de sombra (negro suave)
shadow-color = "#000000";

# Excluir sombras
shadow-exclude = [
    "class_g = 'i3-frame'",
    "class_g = 'Polybar'",
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "fullscreen",
    "_GTK_FRAME_EXTENTS@"
];

#################################
#             Backend             #
#################################

# Backend de renderizado (glx es más rápido)
backend = "glx";

# Configuraciones de rendimiento
glx-no-stencil = true;
glx-no-rebind-pixmap = true;
use-damage = true;

# VSync (evita tearing)
vsync = true;

#################################
#         Window Types            #
#################################

wintypes:
{
    tooltip = { 
        fade = true; 
        shadow = false; 
        opacity = 0.85; 
        focus = true; 
    };
    dock = { 
        shadow = false; 
        opacity = 0.75;
    };
    dnd = { 
        shadow = false; 
    };
    popup_menu = { 
        opacity = 0.92; 
        shadow = true;
        fade = true;
    };
    dropdown_menu = { 
        opacity = 0.92; 
        shadow = true;
        fade = true;
    };
    notification = {
        shadow = true;
        fade = true;
        opacity = 0.80;
    };
    fullscreen = {
        opacity = 1.0;
        blur-background = false;
    };
};

#################################
#        Configuraciones          #
#################################

# Detectar ventanas redondeadas automáticamente
detect-rounded-corners = true;

# Detectar transparencia de clientes
detect-client-opacity = true;

# Usar EWMH para detectar ventanas de pantalla completa
unredir-if-possible = true;

# Marcar ventanas que no responden
mark-wmwin-focused = true;
mark-ovredir-focused = true;

# Configuración adicional para i3wm
focus-exclude = [
    "class_g = 'Cairo-clock'",
    "class_g = 'Bar'",
    "class_g = 'i3-frame'"
];

#################################
#         Experimental            #
#################################

# Mejoras experimentales (descomenta si tienes problemas)
# experimental-backends = true;
# xrender-sync-fence = true;
